<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ø¬Ø¯ÙˆÙ„ Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø±Ù…Ø¶Ø§Ù†</title>
<style>
body { font-family:'Amiri', serif; background:#f0f4f2; margin:0; padding:1rem; }
h1,h2 { text-align:center; color:#1e8b63; }
table { border-collapse: collapse; width:100%; margin-top:1rem; }
th,td { border:1px solid #a9a9a9; padding:0.5rem; text-align:center; }
th { background:#49876d; color:white; }
tbody tr:nth-child(odd) { background:#eee; }
tbody tr:nth-child(even) { background:#fff; }
.friday { background:#cfe3d6 !important; }
button { padding:0.5rem 1rem; margin:0.2rem; cursor:pointer; border-radius:12px; }
#saveBtn { background:#d4af37; color:white; border:none; }
#printBtn { background:#1e8b63; color:white; border:none; }
#saveMessage { display:none; color:green; font-weight:bold; margin-left:0.5rem; }
</style>
</head>
<body>

<h1>Ø¬Ø¯ÙˆÙ„ Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø±Ù…Ø¶Ø§Ù† 1447 Ù‡Ù€</h1>
<h2>Ø§Ù„Ø³ÙŠØ¨ - ÙˆØ§Ø¯ÙŠ Ø§Ù„Ù„ÙˆØ§Ù…ÙŠ</h2>

<div>
  <button id="saveBtn">ğŸ’¾ Ø­ÙØ¸</button>
  <span id="saveMessage">ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­ âœ…</span>
  <button id="printBtn">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
</div>

<table id="mainTable">
<thead>
<tr>
  <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
  <th>Ø§Ù„ÙˆÙ‚Øª</th>
  <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±</th>
  <th>Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„</th>
</tr>
</thead>
<tbody></tbody>
</table>

<script>
const TOTAL_DAYS = 30;
const START_DATE = new Date(2026,1,18); // 18 ÙØ¨Ø±Ø§ÙŠØ± 2026
const weekdays = ["Ø§Ù„Ø£Ø­Ø¯","Ø§Ù„Ø§Ø«Ù†ÙŠÙ†","Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡","Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡","Ø§Ù„Ø®Ù…ÙŠØ³","Ø§Ù„Ø¬Ù…Ø¹Ø©","Ø§Ù„Ø³Ø¨Øª"];
const tbody = document.querySelector("#mainTable tbody");
const WEBAPP_URL = "https://script.google.com/macros/s/AKfycbxIZOlTPz8Bmwa-PEVwPVp5RQ3fAWMtTyOFGXUvi4Kd4Jmm60wa6R8LPTYGN1AjnCoI/exec";

// Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙÙˆÙ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§
for (let i=1; i<=TOTAL_DAYS; i++) {
  const tr = document.createElement("tr");
  const date = new Date(START_DATE);
  date.setDate(START_DATE.getDate() + (i-1));
  const weekdayName = weekdays[date.getDay()];
  if (weekdayName === "Ø§Ù„Ø¬Ù…Ø¹Ø©") tr.classList.add("friday");

  // Ø§Ù„ØªØ§Ø±ÙŠØ®
  const tdDate = document.createElement("td");
  tdDate.contentEditable = true;
  tdDate.textContent = `${date.getDate()}/${date.getMonth()+1}/${date.getFullYear()} - ${weekdayName} - Ø±Ù…Ø¶Ø§Ù† ${i}`;
  tr.appendChild(tdDate);

  // Ø§Ù„ÙˆÙ‚Øª
  const tdTime = document.createElement("td");
  const selectTime = document.createElement("select");
  const options = weekdayName === "Ø§Ù„Ø¬Ù…Ø¹Ø©"
    ? ["Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¬Ù…Ø¹Ø©","Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¹ØµØ±","Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ù…ØºØ±Ø¨","Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¹Ø´Ø§Ø¡"]
    : ["Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¹ØµØ±","Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¸Ù‡Ø±","Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ù…ØºØ±Ø¨","Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¹Ø´Ø§Ø¡"];
  options.forEach(opt => {
    const option = document.createElement("option");
    option.value = opt;
    option.textContent = opt;
    selectTime.appendChild(option);
  });
  tdTime.appendChild(selectTime);
  tr.appendChild(tdTime);

  // Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±
  const tdName = document.createElement("td");
  tdName.contentEditable = true;
  tr.appendChild(tdName);

  // Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„
  const tdPhone = document.createElement("td");
  tdPhone.contentEditable = true;
  tr.appendChild(tdPhone);

  tbody.appendChild(tr);
}

// Ø¯Ø§Ù„Ø© Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Google Sheets
async function saveData(rows) {
  const msg = document.getElementById("saveMessage");
  try {
    const response = await fetch(WEBAPP_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(rows)
    });

    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);

    const result = await response.json();
    console.log(result);

    if (result.status === "success") {
      msg.style.display = "inline";
      setTimeout(() => { msg.style.display = "none"; }, 2000);
    } else {
      alert("âš  Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­ÙØ¸: " + (result.message || "Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"));
    }
  } catch (err) {
    alert("âš  Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­ÙØ¸: " + err.message);
    console.error(err);
  }
}

// Ø­Ø¯Ø« Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø­ÙØ¸
document.getElementById("saveBtn").addEventListener("click", () => {
  const rows = Array.from(document.querySelectorAll("#mainTable tbody tr")).map(tr => {
    const tds = tr.querySelectorAll("td");
    return [
      tds[0].textContent.trim(),
      tds[1].querySelector("select").value,
      tds[2].textContent.trim(),
      tds[3].textContent.trim()
    ];
  });
  saveData(rows);
});

// Ø­Ø¯Ø« Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©
document.getElementById("printBtn").addEventListener("click", () => window.print());

</script>

</body>
</html>
