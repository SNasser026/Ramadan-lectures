<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ุฌุฏูู ูุญุงุถุฑุงุช ุฑูุถุงู</title>
<style>
/* ููุณ CSS ุงูุณุงุจู + ุชุญุณููุงุช ุจุณูุทุฉ */
body { font-family: 'Amiri', serif; background:#f0f4f2; }
table { border-collapse: collapse; width: 100%; }
th, td { border: 1px solid #a9a9a9; padding: 0.5rem; text-align:center; }
th { background:#49876d; color:white; }
tbody tr:nth-child(odd) { background: #eee; }
tbody tr:nth-child(even) { background: #fff; }
.friday { background: #cfe3d6 !important; }
button { padding:0.5rem 1rem; margin:0.2rem; cursor:pointer; border-radius:12px; }
#saveBtn { background:#d4af37; color:white; border:none; }
#printBtn { background:#1e8b63; color:white; border:none; }
#saveMessage { display:none; color:green; font-weight:bold; margin-left:0.5rem; }
</style>
</head>
<body>

<h1>ุฌุฏูู ูุญุงุถุฑุงุช ุฑูุถุงู 1447 ูู</h1>
<h2>ุงูุณูุจ - ูุงุฏู ุงูููุงูู</h2>

<div>
  <button id="saveBtn">๐พ ุญูุธ</button>
  <span id="saveMessage">ุชู ุงูุญูุธ ุจูุฌุงุญ โ</span>
  <button id="printBtn">๐จ๏ธ ุทุจุงุนุฉ</button>
</div>

<table id="mainTable">
<thead>
<tr>
  <th>ุงูุชุงุฑูุฎ</th>
  <th>ุงูููุช</th>
  <th>ุงุณู ุงููุญุงุถุฑ</th>
  <th>ุฑูู ุงูุชูุงุตู</th>
</tr>
</thead>
<tbody></tbody>
</table>

<script>
const TOTAL_DAYS = 30;
const START_DATE = new Date(2026,1,18);
const weekdays = ["ุงูุฃุญุฏ","ุงูุงุซููู","ุงูุซูุงุซุงุก","ุงูุฃุฑุจุนุงุก","ุงูุฎููุณ","ุงูุฌูุนุฉ","ุงูุณุจุช"];
const tbody = document.querySelector("#mainTable tbody");

// ุฅูุดุงุก ุงูุตููู
for (let i=1;i<=TOTAL_DAYS;i++){
  const tr=document.createElement("tr");
  const date=new Date(START_DATE);
  date.setDate(START_DATE.getDate() + (i-1));
  const weekdayName = weekdays[date.getDay()];
  if (weekdayName==="ุงูุฌูุนุฉ") tr.classList.add("friday");

  const tdDate=document.createElement("td");
  tdDate.contentEditable=true;
  tdDate.textContent=`${date.getDate()}/${date.getMonth()+1}/${date.getFullYear()} - ${weekdayName} - ุฑูุถุงู ${i}`;
  tr.appendChild(tdDate);

  const tdTime=document.createElement("td");
  const selectTime=document.createElement("select");
  const options = weekdayName==="ุงูุฌูุนุฉ"
    ? ["ุจุนุฏ ุตูุงุฉ ุงูุฌูุนุฉ","ุจุนุฏ ุตูุงุฉ ุงูุนุตุฑ","ุจุนุฏ ุตูุงุฉ ุงููุบุฑุจ","ุจุนุฏ ุตูุงุฉ ุงูุนุดุงุก"]
    : ["ุจุนุฏ ุตูุงุฉ ุงูุนุตุฑ","ุจุนุฏ ุตูุงุฉ ุงูุธูุฑ","ุจุนุฏ ุตูุงุฉ ุงููุบุฑุจ","ุจุนุฏ ุตูุงุฉ ุงูุนุดุงุก"];
  options.forEach(opt=>{
    const option=document.createElement("option");
    option.value=opt; option.textContent=opt; selectTime.appendChild(option);
  });
  tdTime.appendChild(selectTime);
  tr.appendChild(tdTime);

  const tdName=document.createElement("td"); tdName.contentEditable=true; tr.appendChild(tdName);
  const tdPhone=document.createElement("td"); tdPhone.contentEditable=true; tr.appendChild(tdPhone);

  tbody.appendChild(tr);
}

// ุฑุงุจุท Web App
const WEBAPP_URL = "https://script.google.com/macros/s/AKfycbz8Xn4gP_CN61xEVF7g3Nkn7gaXF_eK5swDXu-clNbdWKE3OazeCGJ5HwxxEz-xuMZqZQ/exec";

document.getElementById("saveBtn").addEventListener("click", async ()=>{
  const rows=[];
  document.querySelectorAll("#mainTable tbody tr").forEach(tr=>{
    const tds=tr.querySelectorAll("td");
    rows.push([tds[0].textContent.trim(), tds[1].querySelector("select").value, tds[2].textContent.trim(), tds[3].textContent.trim()]);
  });
  try{
    const res=await fetch(WEBAPP_URL,{
      method:"POST",
      mode:"cors",
      headers:{"Content-Type":"application/json"},
      body: JSON.stringify(rows)
    });
    const result=await res.json();
    console.log(result);
    if(result.status==="success"){
      const msg=document.getElementById("saveMessage");
      msg.style.display="inline";
      setTimeout(()=>{msg.style.display="none";},2000);
    }
  }catch(err){
    alert("โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุญูุธ!");
    console.error(err);
  }
});

document.getElementById("printBtn").addEventListener("click",()=>window.print());
</script>

</body>
</html>
